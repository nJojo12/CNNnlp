Improved CNN Text Classifier for Harry Potter Books
============================================================
Loaded pre-trained embeddings: (8964, 100)
Loaded HP1: 347 pages
Loaded HP2: 377 pages
Loaded HP3: 486 pages
Loaded HP4: 808 pages
Loaded HP5: 1104 pages
Loaded HP6: 728 pages
Loaded HP7: 849 pages
Using pre-trained vocabulary: 8964 words + padding = 8965 total
Index range: 0 (padding) to 8964
Created 4817 training samples
Sequence shape: (4817, 200)
Labels shape: (4817, 7)
Vocabulary size for embedding layer: 8965
Max index in sequences: 8964
Min index in sequences: 0
All indices are within bounds - should work correctly!

Class distribution:
  HP1: 354 samples
  HP2: 381 samples
  HP3: 490 samples
  HP4: 839 samples
  HP5: 1126 samples
  HP6: 747 samples
  HP7: 880 samples
Found pre-trained embeddings for 8964/8965 words
Embedding matrix shape: (8965, 100)
Using pre-trained embeddings

Model architecture:
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 200)       │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ embedding           │ (None, 200, 100)  │    896,500 │ input_layer[0][0] │
│ (Embedding)         │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout (Dropout)   │ (None, 200, 100)  │          0 │ embedding[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d (Conv1D)     │ (None, 200, 128)  │     38,528 │ dropout[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_1 (Conv1D)   │ (None, 200, 128)  │     51,328 │ dropout[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_2 (Conv1D)   │ (None, 200, 128)  │     64,128 │ dropout[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_max_pooling… │ (None, 128)       │          0 │ conv1d[0][0]      │
│ (GlobalMaxPooling1… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_max_pooling… │ (None, 128)       │          0 │ conv1d_1[0][0]    │
│ (GlobalMaxPooling1… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_max_pooling… │ (None, 128)       │          0 │ conv1d_2[0][0]    │
│ (GlobalMaxPooling1… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 384)       │          0 │ global_max_pooli… │
│ (Concatenate)       │                   │            │ global_max_pooli… │
│                     │                   │            │ global_max_pooli… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 384)       │          0 │ concatenate[0][0] │
│ (Concatenate)       │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense (Dense)       │ (None, 256)       │     98,560 │ concatenate_1[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_1 (Dropout) │ (None, 256)       │          0 │ dense[0][0]       │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_1 (Dense)     │ (None, 128)       │     32,896 │ dropout_1[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_2 (Dropout) │ (None, 128)       │          0 │ dense_1[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_2 (Dense)     │ (None, 7)         │        903 │ dropout_2[0][0]   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 1,182,843 (4.51 MB)
 Trainable params: 286,343 (1.09 MB)
 Non-trainable params: 896,500 (3.42 MB)

Data splits:
  Training: 3082 samples
  Validation: 771 samples
  Testing: 964 samples

Training model...
Epoch 1/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m6:32[0m 8s/step - accuracy: 0.0781 - loss: 2.5967[1m13/49[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.1533 - loss: 2.3089 [1m26/49[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.1662 - loss: 2.2033[1m38/49[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.1760 - loss: 2.1517[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 103ms/step - accuracy: 0.1807 - loss: 2.1222[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m16s[0m 166ms/step - accuracy: 0.1979 - loss: 2.0141 - val_accuracy: 0.2425 - val_loss: 1.9260 - learning_rate: 0.0010
Epoch 2/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 25ms/step - accuracy: 0.2344 - loss: 1.9554[1m16/49[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.2136 - loss: 1.9424 [1m29/49[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.2111 - loss: 1.9415[1m41/49[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.2118 - loss: 1.9378[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 6ms/step - accuracy: 0.2187 - loss: 1.9226 - val_accuracy: 0.2789 - val_loss: 1.8916 - learning_rate: 0.0010
Epoch 3/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 26ms/step - accuracy: 0.2656 - loss: 1.8791[1m15/49[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.2299 - loss: 1.9214 [1m27/49[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.2341 - loss: 1.9154[1m38/49[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.2363 - loss: 1.9102[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 4ms/step - accuracy: 0.2394 - loss: 1.9040[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.2576 - loss: 1.8745 - val_accuracy: 0.3243 - val_loss: 1.7699 - learning_rate: 0.0010
Epoch 4/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 26ms/step - accuracy: 0.2500 - loss: 1.8337[1m16/49[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.2841 - loss: 1.7912 [1m28/49[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.2910 - loss: 1.7802[1m40/49[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.2941 - loss: 1.7729[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.3134 - loss: 1.7384 - val_accuracy: 0.3346 - val_loss: 1.6794 - learning_rate: 0.0010
Epoch 5/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 27ms/step - accuracy: 0.4688 - loss: 1.3558[1m14/49[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.3578 - loss: 1.6285 [1m26/49[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.3417 - loss: 1.6570[1m38/49[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.3358 - loss: 1.6694[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 4ms/step - accuracy: 0.3328 - loss: 1.6765[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.3232 - loss: 1.6998 - val_accuracy: 0.3372 - val_loss: 1.6859 - learning_rate: 0.0010
Epoch 6/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 25ms/step - accuracy: 0.3594 - loss: 1.7203[1m15/49[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.3378 - loss: 1.6917 [1m27/49[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.3368 - loss: 1.6911[1m39/49[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.3392 - loss: 1.6849[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.3410 - loss: 1.6684 - val_accuracy: 0.3852 - val_loss: 1.6306 - learning_rate: 0.0010
Epoch 7/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 27ms/step - accuracy: 0.3750 - loss: 1.5108[1m16/49[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 3ms/step - accuracy: 0.3705 - loss: 1.6004 [1m27/49[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.3697 - loss: 1.6015[1m38/49[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.3694 - loss: 1.6019[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 4ms/step - accuracy: 0.3681 - loss: 1.6029[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 6ms/step - accuracy: 0.3653 - loss: 1.6028 - val_accuracy: 0.3982 - val_loss: 1.5573 - learning_rate: 0.0010
Epoch 8/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 35ms/step - accuracy: 0.4062 - loss: 1.5626[1m14/49[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.4098 - loss: 1.5547 [1m26/49[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.4017 - loss: 1.5564[1m37/49[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.4001 - loss: 1.5528[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 4ms/step - accuracy: 0.4000 - loss: 1.5489[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.4001 - loss: 1.5358 - val_accuracy: 0.4189 - val_loss: 1.5121 - learning_rate: 0.0010
Epoch 9/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 41ms/step - accuracy: 0.3594 - loss: 1.5268[1m15/49[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.3839 - loss: 1.5008 [1m26/49[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.3970 - loss: 1.4884[1m38/49[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.4041 - loss: 1.4776[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 4ms/step - accuracy: 0.4082 - loss: 1.4722[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.4212 - loss: 1.4572 - val_accuracy: 0.4034 - val_loss: 1.5040 - learning_rate: 0.0010
Epoch 10/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 28ms/step - accuracy: 0.4531 - loss: 1.4366[1m14/49[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.4394 - loss: 1.4581 [1m25/49[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.4405 - loss: 1.4463[1m36/49[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.4424 - loss: 1.4355[1m47/49[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 4ms/step - accuracy: 0.4442 - loss: 1.4253[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.4507 - loss: 1.3865 - val_accuracy: 0.4553 - val_loss: 1.4004 - learning_rate: 0.0010
Epoch 11/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 26ms/step - accuracy: 0.5312 - loss: 1.0861[1m14/49[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.4920 - loss: 1.2423 [1m25/49[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.4872 - loss: 1.2607[1m36/49[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.4878 - loss: 1.2656[1m47/49[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 4ms/step - accuracy: 0.4889 - loss: 1.2669[1m49/49[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 7ms/step - accuracy: 0.4916 - loss: 1.2710 - val_accuracy: 0.4695 - val_loss: 1.3678 - learning_rate: 0.0010
Epoch 12/50
[1m 1/49[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 39ms/step - accuracy: 0.4688 - loss: 1.2640[1m14/49[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.5035 - loss: 1.2129 [1m25/49[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 4ms/step - accuracy: 0.5173 - loss: 1.1884