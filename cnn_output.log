Improved CNN Text Classifier for Harry Potter Books
============================================================
Loaded pre-trained embeddings: (2384, 100)
Loaded HP1: 347 pages
Loaded HP2: 377 pages
Loaded HP3: 486 pages
Loaded HP4: 808 pages
Loaded HP5: 1104 pages
Loaded HP6: 728 pages
Loaded HP7: 849 pages
Using pre-trained vocabulary: 2384 words + padding = 2385 total
Index range: 0 (padding) to 2384
Created 4817 training samples
Sequence shape: (4817, 200)
Labels shape: (4817, 7)
Vocabulary size for embedding layer: 2385
Max index in sequences: 2384
Min index in sequences: 0
All indices are within bounds - should work correctly!

Class distribution:
  HP1: 354 samples
  HP2: 381 samples
  HP3: 490 samples
  HP4: 839 samples
  HP5: 1126 samples
  HP6: 747 samples
  HP7: 880 samples
Found pre-trained embeddings for 2384/2385 words
Embedding matrix shape: (2385, 100)
Using pre-trained embeddings

Model architecture:
Model: "functional"
┏━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━┓
┃ Layer (type)        ┃ Output Shape      ┃    Param # ┃ Connected to      ┃
┡━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━┩
│ input_layer         │ (None, 200)       │          0 │ -                 │
│ (InputLayer)        │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ embedding           │ (None, 200, 100)  │    238,500 │ input_layer[0][0] │
│ (Embedding)         │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout (Dropout)   │ (None, 200, 100)  │          0 │ embedding[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d (Conv1D)     │ (None, 200, 128)  │     38,528 │ dropout[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_1 (Conv1D)   │ (None, 200, 128)  │     51,328 │ dropout[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ conv1d_2 (Conv1D)   │ (None, 200, 128)  │     64,128 │ dropout[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_max_pooling… │ (None, 128)       │          0 │ conv1d[0][0]      │
│ (GlobalMaxPooling1… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_max_pooling… │ (None, 128)       │          0 │ conv1d_1[0][0]    │
│ (GlobalMaxPooling1… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ global_max_pooling… │ (None, 128)       │          0 │ conv1d_2[0][0]    │
│ (GlobalMaxPooling1… │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate         │ (None, 384)       │          0 │ global_max_pooli… │
│ (Concatenate)       │                   │            │ global_max_pooli… │
│                     │                   │            │ global_max_pooli… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ concatenate_1       │ (None, 384)       │          0 │ concatenate[0][0] │
│ (Concatenate)       │                   │            │                   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense (Dense)       │ (None, 256)       │     98,560 │ concatenate_1[0]… │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_1 (Dropout) │ (None, 256)       │          0 │ dense[0][0]       │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_1 (Dense)     │ (None, 128)       │     32,896 │ dropout_1[0][0]   │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dropout_2 (Dropout) │ (None, 128)       │          0 │ dense_1[0][0]     │
├─────────────────────┼───────────────────┼────────────┼───────────────────┤
│ dense_2 (Dense)     │ (None, 7)         │        903 │ dropout_2[0][0]   │
└─────────────────────┴───────────────────┴────────────┴───────────────────┘
 Total params: 524,843 (2.00 MB)
 Trainable params: 286,343 (1.09 MB)
 Non-trainable params: 238,500 (931.64 KB)

Data splits:
  Training: 3082 samples
  Validation: 771 samples
  Testing: 964 samples

Training model...

Final Results:
Test accuracy: 0.4927 (49.27%)
Test loss: 1.4689
[1m 1/31[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m24s[0m 808ms/step[1m26/31[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 2ms/step   [1m31/31[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 25ms/step[1m31/31[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m2s[0m 26ms/step

Classification Report:
              precision    recall  f1-score   support

         HP1       0.23      0.45      0.30        71
         HP2       0.25      0.07      0.10        76
         HP3       0.27      0.40      0.33        98
         HP4       0.93      0.65      0.77       168
         HP5       0.50      0.54      0.52       225
         HP6       0.90      0.25      0.40       150
         HP7       0.50      0.73      0.60       176

    accuracy                           0.49       964
   macro avg       0.51      0.44      0.43       964
weighted avg       0.58      0.49      0.49       964

